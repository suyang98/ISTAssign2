<html>
<head>
    <title>Collecting Captions</title>
    <meta charset="utf-8">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous"> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <style>
        /* Your own CSS code */
        #submission_block {
            margin-top: 20px;
        }
        .highlight {
            background-color: yellow;
            color: red;
            font-weight: bold;
        }
        .underline {
            font-weight: bold;
            text-decoration: underline;
        }
        .red {
            color: red;
        }
        .black {
            color: black;
        }
    </style>

    <script>
        /* Your own JavaScript code */

        $(document).ready(function() {
            
            var imgArr = ['sample/img/1001.2938v1-Figure9-1.png','sample/img/1004.4612v1-Figure6-1.png','sample/img/1102.2936v3-Figure4-1.png'];
            var index = Math.floor((Math.random()*imgArr.length));
            var imgSrc = imgArr[index];
            var imgEle = document.getElementById('test_img')[0];
            imgEle.setAttribute('src',imgSrc);
            // Time Lock
            // (1) init time_left
            var time_left = 5;
            
            // (2) create setInterval function.
            var interval_id = setInterval(function() {
                // count down 1 second
                time_left -= 1;
                
                // if time_left == 0 => turn on the submit-btn
                //                   => remove time information on the button
                //                   => stop setInterval function
                if (time_left == 0) {
                    $("#submit-btn").prop("disabled", false);
                    $("#submit-btn").text("Submit");
                    clearInterval(interval_id);
                } else {
                    // if time_left => display time information to users
                    $("#submit-btn").text("Submit ("+time_left+")");
                }
            }, 1000);

            //If no error is detected 
            $("#No-error").change(function() {
                var box = document.getElementsByName('error-group');
                if (box[3].checked) {
                    if (box[0].checked||box[1].checked||box[2].checked){
                        alert("Please read the first question carefully!");
                    }
                    $("#00").prop("disabled", false);
                    $("#01").prop("disabled", false);
                    $("#02").prop("disabled", false);
                    $("#03").prop("disabled", false);
                    $("#04").prop("disabled", false);
                    $("#10").prop("disabled", false);
                    $("#11").prop("disabled", false);
                    $("#12").prop("disabled", false);
                    $("#13").prop("disabled", false);
                    $("#14").prop("disabled", false);
                } else {
                    $("#00").prop("disabled", true);$("#00").prop("checked", false);
                    $("#01").prop("disabled", true);$("#01").prop("checked", false);
                    $("#02").prop("disabled", true);$("#02").prop("checked", false);
                    $("#03").prop("disabled", true);$("#03").prop("checked", false);
                    $("#04").prop("disabled", true);$("#04").prop("checked", false);
                    $("#10").prop("disabled", true);$("#10").prop("checked", false);
                    $("#11").prop("disabled", true);$("#11").prop("checked", false);
                    $("#12").prop("disabled", true);$("#12").prop("checked", false);
                    $("#13").prop("disabled", true);$("#13").prop("checked", false);
                    $("#14").prop("disabled", true);$("#14").prop("checked", false);
                }
            });
            
            // Add submission function
            $("#submit-btn").click(function() {
                var names = document.getElementsByName('error-group');
                for (var i=0; i<3; i++){
                    if (names[i].checked){
                        $("#worker-form").submit();
                        return true;
                    }
                }
                if (!names[3].checked) {
                    alert("Please check if there is an error in this sample!");
                    return false;
                }
                var flag1=false, flag2=false;
                var names1=document.getElementsByName('match-group');
                var names2=document.getElementsByName('clear-group');
                for (var i=0; i<5; i++){
                    if (names1[i].checked){
                        flag1=true;
                        break;
                    } 
                }
                for (var i=0; i<5; i++){
                    if (names2[i].checked){
                        flag2=true;
                        break;
                    } 
                }
                if (!flag1){
                    alert("Please evaluate if the caption matches the figure!");
                    return false;
                }
                if (!flag2){
                    alert("Please evaluate if the caption clearly describes the figure!");
                    return false;
                }
                alert("Submit Successfully!")
                $("#worker-form").submit();
            });

        });
    </script>
</head>
<body>
    <!-- Your own HTML code -->
    <div class="container">
        <form id="worker-form">
            <div class="row">
                <div class="col-12">
                    <h1> Instruction </h1>
                        <p> In this task, you will see a figure from an academic paper and the caption of it. Please read them carefully and  <span class="highlight">evaluate the quality of the caption </span> . </p>
                        <ul>
                            <li>  First, if there are errors in the sample, you could <span class="underline">report errors on the rightside</span>. </li> 
                            <li>  Second, if there is no error, please  <span class="underline">chose the corresponding option to evaluate the quality of the caption</span>. </li>
                        </ul><br>
                </div>
            </div>

            <div class="row">
                <div class="col-6">
                    <img class="rounded mx-auto d-block" id="test_img" src="sample/img/1001.2938v1-Figure9-1.png" width="100%">
                    <p><strong>Here should be a random caption.</strong> </p>

                </div>
                <div class="col-6">
                    <form action="/submit_error.php">
                        <p><strong>Are the following errors appearing in the figure and the caption? </strong> </p>
                        <input type="checkbox" id="Figure-Extraction" name="error-group" value="Figure-Extraction">
                        <label for="Figure-Extraction">Figure extraction errors</label> 
                        <input type="checkbox" id="Caption-Extraction" name="error-group" value="Caption-Extraction">
                        <label for="Caption-Extraction">Caption extraction errors</label><br> 
                        <input type="checkbox" id="Hard-to-Understand" name="error-group" value="Hard-to-Understand">
                        <label for="Hard-to-Understand">Hard-to-understand captions</label>
                       <input type="checkbox" id="No-error" name="error-group" value="No-error">
                       <label for="No-error">No error exists</label><br>
                      </form>
                      
                    <form action="/quality.php">
                        <p><strong>The caption matches the figure. </strong></p>
                        <input type="radio" id="00" name="match-group" value="00" disabled=True>
                        <label for="00"> Totally disagree</label><br>
                        <input type="radio" id="01" name="match-group" value="01" disabled=True>
                        <label for="01">Disagree a little</label><br>
                        <input type="radio" id="02" name="match-group" value="02" disabled=True>
                        <label for="02">Neutral opinion</label><br>
                        <input type="radio" id="03" name="match-group" value="03" disabled=True>
                        <label for="03">Agree a little</label><br>
                        <input type="radio" id="04" name="match-group" value="04" disabled=True>
                        <label for="04">Totally agree</label><br>
                        <p><strong>The caption clearly describes the figure.</strong></p>
                        <input type="radio" id="10" name="clear-group" value="10" disabled=True>
                        <label for="10">Totally disagree</label><br>
                        <input type="radio" id="11" name="clear-group" value="11" disabled=True>
                        <label for="11">Disagree a little</label><br>
                        <input type="radio" id="12" name="clear-group" value="12" disabled=True>
                        <label for="12">Neutral opinion</label><br>
                        <input type="radio" id="13" name="clear-group" value="13" disabled=True>
                        <label for="13">Agree a little</label><br>
                        <input type="radio" id="14" name="clear-group" value="14" disabled=True>
                        <label for="14">Totally agree</label><br>
                      </form>
                      
                </div>
            </div>
            <div class="row" id="submission_block">
                <div class="col-12">
                    <button 
                        disabled 
                        id="submit-btn" 
                        type="button" 
                        class="btn btn-outline-primary btn-block"
                    >
                        Submit
                    </button>
                </div>
            </div>
        </form>
    </div>

</body>
</html>